# Конфигурационный парсер (Config Parser)

---

## 1. Общее описание

Данный проект реализует инструмент командной строки для преобразования конфигурационных файлов, написанных на специальном синтаксическом языке, в формат JSON. Инструмент поддерживает работу с однострочными и многострочными комментариями, объявление переменных, массивов, строк и константных ссылок. Проект включает модульные тесты, обеспечивающие корректность работы парсера.

---

## 2. Функции и настройки

### Основные функции

- **Преобразование конфигураций в JSON:**
  - Парсинг входного конфигурационного файла.
  - Вывод результата в формате JSON, включающем переменные и итоговое значение.

- **Обработка комментариев:**
  - **Однострочные комментарии:** Начинаются с `||` и продолжаются до конца строки.
  - **Многострочные комментарии:** Заключены между `/+` и `+/`.

- **Объявление переменных:**
  - Использование ключевого слова `var` для объявления переменных.
  - Синтаксис: `var имя := значение`.

- **Поддержка массивов и строк:**
  - **Массивы:** Объявляются с использованием `array(значение1, значение2, ...)`.
  - **Строки:** Заключаются в двойные квадратные скобки `[[строка]]`.

- **Константные ссылки:**
  - Ссылки на переменные оформляются как `.{имя}.` и заменяются на соответствующие значения при парсинге.

### Пример синтаксиса

```plaintext
|| Это комментарий
var timeout := 30
var greeting := [[Hello world]]
var message := [[The greeting is: .{greeting}. and timeout is .{timeout}.]]
var values := array(1, 2, 3, .{timeout}.)
array( .{message}., .{values}. )
```
### Пример JSON-вывода
```json
{
  "variables": {
    "timeout": 30,
    "greeting": "Hello world",
    "message": "The greeting is: Hello world and timeout is 30",
    "values": [1, 2, 3, 30]
  },
  "_result": [
    "The greeting is: Hello world and timeout is 30",
    [
      1,
      2,
      3,
      30
    ]
  ]
}
```
### Основные компоненты
1. **Парсер (```config_parser.py```)**

- Реализует логику парсинга конфигурационного языка.
- Обрабатывает объявления переменных, массивов, строк и константных ссылок.
- Генерирует итоговый JSON-объект.
2. **Командная строка (```cli.py```)**

- Интерфейс для взаимодействия с пользователем.
- Принимает входной конфигурационный файл и путь к выходному JSON-файлу.
- Использует парсер из config_parser.py для обработки конфигурации и записи результата.
3. **Тесты (```test_config_parser.py```)**

- Модульные тесты, проверяющие корректность работы парсера.
- Покрывают различные сценарии, включая правильный парсинг, обработку ошибок и замену константных ссылок.
4. **Примеры конфигурационных файлов (`example`)**

- example1.conf: Пример базовой конфигурации.
- example2.conf: Пример конфигурации с константными ссылками и массивами.
5. **Выходные JSON-файлы (`output1.json`, `output2.json`)**

- Примеры результатов преобразования конфигурационных файлов в JSON.
## 3. Использование
### Запуск парсера
Для преобразования конфигурационного файла в JSON используйте следующую команду:
``` bash
python cli.py <input.conf> <output.json>
```
#### Примеры:
- Преобразование `example1.conf` в `output1.json`:

``` bash
python cli.py examples/example1.conf output1.json

```
- Преобразование `example2.conf` в `output2.json`:
``` bash
python cli.py examples/example2.conf output2.json
```
#### Просмотр результата
После успешного выполнения команды, файл `output1.json` или `output2.json` будет содержать результат в формате JSON.

**Пример содержимого**  `output2.json`:
```json
{
  "variables": {
    "hostname": "server1",
    "ports": [80, 443, 8080],
    "welcome_msg": "Welcome to server1!"
  },
  "_result": "Welcome to server1!"
}
```


## 4. Примеры использования
### Пример 1: Базовая конфигурация
**Входной файл `example1.conf`:**
```plaintext
|| Это комментарий
var timeout := 30
var greeting := [[Hello world]]
var message := [[The greeting is: .{greeting}. and timeout is 30]]
var values := array(1, 2, 3, .{timeout}.)
array( .{message}., .{values}. )
```
**Команда для запуска:**
``` bash
python cli.py example1.conf output1.json
```
**Результат работы программы (`output1.json`)**:
```json
{
  "variables": {
    "timeout": 30,
    "greeting": "Hello world",
    "message": "The greeting is: Hello world and timeout is 30",
    "values": [1, 2, 3, 30]
  },
  "_result": [
    "The greeting is: Hello world and timeout is 30",
    [
      1,
      2,
      3,
      30
    ]
  ]
}
```
### Пример 2: Конфигурация с константными ссылками
**Входной файл `example2.conf`:**
```plaintext
var hostname := [[server1]]
var ports := array(80, 443, 8080)
var welcome_msg := [[Welcome to .{hostname}.!]]
.{welcome_msg}.
```
**Команда для запуска:**
```bash
python cli.py examples/example2.conf output2.json
```
**Результат работы программы (`output2.json`):**
```json
{
  "variables": {
    "hostname": "server1",
    "ports": [80, 443, 8080],
    "welcome_msg": "Welcome to server1!"
  },
  "_result": "Welcome to server1!"
}
```
## 5. Результаты прогона тестов
Все тестовые файлы успешно обработаны, подтверждая корректность работы всех функций парсера.
**Запуск тестов с использованием `pytest` (если установлен)**
``` bash
pytest
```
**Вывод тестирования (`test_config_parser.py`):**
<img width="1212" alt="image" src="https://github.com/user-attachments/assets/c220b634-f820-4cb6-a763-1092cd9262a1">

### Проверка корректности результатов
- Корректное парсинг переменных.
- Правильная замена константных ссылок.
- Обработка массивов и строк.
- Удаление комментариев.
- Обработка синтаксических ошибок.
**Все тесты прошли успешно, подтверждая полное соответствие функционала требованиям задания.**
  
## 6. Ошибки и их обработка
Программа выводит сообщения об ошибках в следующих случаях:

- **Некорректные имена переменных:**
  - Если имя переменной не соответствует шаблону ^[a-zA-Z][a-zA-Z0-9_]*$, программа завершится с ошибкой.
- **Синтаксические ошибки в конфигурационном файле:**
  - Если конфигурационный файл содержит синтаксические ошибки (например, отсутствует := при объявлении переменной), программа завершится с соответствующим сообщением.
- **Неопределенные константные ссылки:**
  - Если в строке или массиве используется константная ссылка на несуществующую переменную, программа завершится с ошибкой.










































